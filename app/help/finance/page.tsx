"use client";

import AuthLayout from "@/components/ui/AuthLayout";
import PageHeader from "@/components/ui/PageHeader";
import { Printer } from "lucide-react";

// โโโ Section component โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
function Section({ id, title, icon, children }: {
  id?: string;
  title: string;
  icon: string;
  children: React.ReactNode;
}) {
  return (
    <div id={id} className="card mb-6">
      <h2 className="text-xl font-bold text-navy-500 mb-4 flex items-center gap-2">
        <span className="text-2xl">{icon}</span> {title}
      </h2>
      {children}
    </div>
  );
}

// โโโ Formula row โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
function Formula({ label, formula, result, note }: {
  label: string;
  formula: string;
  result?: string;
  note?: string;
}) {
  return (
    <div className="bg-gray-50 rounded-xl p-4 mb-3 border border-gray-100">
      <p className="font-bold text-navy-500 mb-1">{label}</p>
      <p className="font-mono text-sm bg-navy-500 text-white rounded-lg px-3 py-2 dir-ltr text-left mb-1">
        {formula}
      </p>
      {result && <p className="text-emerald-600 font-bold text-sm">ูุซุงู: {result}</p>}
      {note && <p className="text-gray-500 text-xs mt-1">{note}</p>}
    </div>
  );
}

// โโโ Field row โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
function Field({ name, desc, example }: { name: string; desc: string; example?: string }) {
  return (
    <div className="flex items-start gap-3 py-3 border-b border-gray-100 last:border-0">
      <div className="w-2 h-2 rounded-full bg-navy-500 mt-2 shrink-0" />
      <div className="flex-1">
        <span className="font-bold text-navy-500">{name}: </span>
        <span className="text-gray-600 text-sm">{desc}</span>
        {example && (
          <p className="text-xs text-gray-400 mt-0.5 bg-gray-50 rounded px-2 py-0.5 inline-block mr-2">
            ูุซุงู: {example}
          </p>
        )}
      </div>
    </div>
  );
}

// โโโ Status badge โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
function StatusInfo({ label, color, desc }: { label: string; color: string; desc: string }) {
  return (
    <div className="flex items-start gap-3 py-2">
      <span className={`text-xs font-bold px-2 py-1 rounded-full shrink-0 ${color}`}>{label}</span>
      <p className="text-gray-600 text-sm">{desc}</p>
    </div>
  );
}

export default function FinanceGuidePage() {
  return (
    <AuthLayout>
      <div id="print-area">
        <PageHeader
          title="ุงูุฏููู ุงููุงูู"
          subtitle="ุดุฑุญ ูุงูู ูุฌููุน ุงูุฃุฑูุงู ุงููุงููุฉ ูููู ุชูุญุณุจ"
        >
          <button
            onClick={() => window.print()}
            className="btn-secondary flex items-center gap-2 text-sm no-print"
          >
            <Printer size={16} /> ุทุจุงุนุฉ
          </button>
        </PageHeader>

        {/* โโ Table of Contents โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <div className="card mb-6 no-print">
          <p className="font-bold text-navy-500 mb-3">ููุฑุณ ุงููุญุชูู</p>
          <div className="grid grid-cols-2 sm:grid-cols-3 gap-2 text-sm">
            {[
              ["1", "ููู ูุนูู ุงููุธุงู"],
              ["2", "ุฏูุฑุฉ ุงูุญูุงุฉ ุงููุงููุฉ ููุนูุฏ"],
              ["3", "ุตูุญุฉ ุงูุนูุฏ โ ูู ุญูู"],
              ["4", "ุฏูุชุฑ ุงูุฃุณุชุงุฐ (ุงูุณุฌู)"],
              ["5", "ุงูุญุงูุงุช ุงููุงููุฉ ุงูุณุชุฉ"],
              ["6", "ุงูุชูุงุฑูุฑ ุงููุงููุฉ"],
              ["7", "ุงูุชุญูููุงุช"],
              ["8", "ุงูุนููุฏ ุงููุชุฃุฎุฑุฉ"],
              ["9", "ููุญุฉ ุงููุงูู"],
              ["10", "ุญุณุงุจุงุช ุงูููุงุชุจ ุงูุฎุงุฑุฌูุฉ"],
              ["11", "ุฃุญุฏุงุซ ุงูุถูุงู ูุนูุฏุฉ ุงูุนุงููุฉ"],
              ["12", "ูุญุฑู ุงูุฅุฌุฑุงุกุงุช ุงููุงููุฉ ุงูุชููุงุฆูุฉ"],
            ].map(([n, t]) => (
              <a
                key={n}
                href={`#sec${n}`}
                className="flex items-center gap-2 p-2 rounded-lg hover:bg-navy-50 text-navy-500 font-bold"
              >
                <span className="w-6 h-6 rounded-full bg-navy-500 text-white text-xs flex items-center justify-center shrink-0">{n}</span>
                {t}
              </a>
            ))}
          </div>
        </div>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 1: How the system works                          */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec1" title="ููู ูุนูู ุงููุธุงูุ" icon="๐๏ธ">
          <p className="text-gray-600 mb-4 leading-relaxed">
            ุงููุธุงู ูุนูู ุจูุจุฏุฃ <strong>ุงูุณุฌู ุงููุญุงุณุจู ุงูุบูุฑ ูุงุจู ููุชุนุฏูู (Immutable Ledger)</strong>.
            ูู ุนูููุฉ ูุงููุฉ ุชูุณุฌููู ูุฑุฉ ูุงุญุฏุฉ ููุง ุชูุญุฐู ููุง ุชูุนุฏููู ุฃุจุฏุงู. ุงูุฑุจุญ ุงูุญูููู
            ูุฃู ุนูุฏ ููุญุณุจ ูู ูุฌููุน ุงูุญุฑูุงุช ูู ุฏูุชุฑ ุงูุฃุณุชุงุฐุ ูููุณ ูู ุงูุฃุฑูุงู ุงูุชูุฏูุฑูุฉ ููุท.
          </p>
          <div className="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4">
            <p className="font-bold text-blue-800 mb-2">ุงููุตุฏุฑ ุงูุญูููู ููุฃุฑูุงู:</p>
            <div className="grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm">
              <div className="bg-white rounded-lg p-3 border border-blue-100">
                <p className="font-bold text-navy-500">ุฌุฏูู ุงูุนููุฏ (contracts)</p>
                <p className="text-gray-500 text-xs mt-1">ุงูุจูุงูุงุช ุงููุฏุฎูุฉ: ูุจูุบ ุงูุนูููุ ุงูุนูููุงุชุ ุฑุณูู ูุณุงูุฏ โ ููุญุณุจ ููู ุงูุฑุจุญ ุงูุชูุฑูุจู</p>
              </div>
              <div className="bg-white rounded-lg p-3 border border-blue-100">
                <p className="font-bold text-navy-500">ุฌุฏูู ุงูุญุฑูุงุช (transactions)</p>
                <p className="text-gray-500 text-xs mt-1">ุงูุณุฌู ุงููุญุงุณุจู ุงูุบูุฑ ูุงุจู ููุชุนุฏูู โ ููุญุณุจ ููู ุงูุฑุจุญ ุงูุญูููู</p>
              </div>
              <div className="bg-white rounded-lg p-3 border border-blue-100">
                <p className="font-bold text-navy-500">ุฌุฏูู ูุฏููุนุงุช ุงูููุงุชุจ (external_accounts)</p>
                <p className="text-gray-500 text-xs mt-1">ุณุฌู ุงูุชุญูููุงุช ุงููุนููุฉ ููููุงุชุจ ุงูุฎุงุฑุฌูุฉ โ ุจุงูุฏููุงุฑ</p>
              </div>
            </div>
          </div>
          <div className="bg-emerald-50 border border-emerald-200 rounded-xl p-4">
            <p className="font-bold text-emerald-800 mb-2">โจ ุงููุญุฑู ุงูุชููุงุฆู โ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ ูููุดุฆ ุงููููุฏ:</p>
            <p className="text-emerald-700 text-sm">
              ูู ุชุนุฏ ุจุญุงุฌุฉ ูุฅุฏุฎุงู ุงููููุฏ ุงููุญุงุณุจูุฉ ูุฏููุงู ูู ูุนุธู ุงูุญุงูุงุช. ุจูุฌุฑุฏ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ
              (ุชู ุงูุชุนุงูุฏ / ุชู ุงููุตูู / ููุบู / ูุฑูุจ / ุฅุฑุฌุงุน)ุ ูุนุฑุถ ุงููุธุงู ูุงูุฐุฉ ุชุฃููุฏ ุซู ููุณุฌูู
              ุงููููุฏ ุงูููุงุณุจุฉ ุชููุงุฆูุงู ูู ุฏูุชุฑ ุงูุฃุณุชุงุฐ. ุฑุงุฌุน ุงููุณู 12 ููุชูุงุตูู ุงููุงููุฉ.
            </p>
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 2: Financial lifecycle                           */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec2" title="ุฏูุฑุฉ ุงูุญูุงุฉ ุงููุงููุฉ ููุนูุฏ" icon="๐">
          <div className="relative">
            {[
              {
                step: "1", color: "bg-blue-500", title: "ุฏูุน ุงูุนููู",
                desc: "ูุฏูุน ุงูุนููู ุงููุจูุบ ุงููุงูู ุฅูู ููุตุฉ ูุณุงูุฏ ูุณุจูุงู ูุจู ุงูุงุณุชูุฏุงู.",
              },
              {
                step: "2", color: "bg-indigo-500", title: "ุฅุตุฏุงุฑ ุงูุนูุฏ (contracted) โ ุฌุฏูุฏ",
                desc: "ุจูุฌุฑุฏ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ ุฅูู ยซุชู ุงูุชุนุงูุฏยปุ ูููุดุฆ ุงููุธุงู ุชููุงุฆูุงู ููุฏ EXTERNAL_COMMISSION_FORECAST (ุชููุน ุนูููุฉ ุงูููุชุจ ุงูุฎุงุฑุฌู). ูุฐุง ุฑูู ุชูุจุคู โ ููุนูุณ ูุงุญูุงู ุฅุฐุง ุฃููุบู ุงูุนูุฏ.",
              },
              {
                step: "3", color: "bg-yellow-500", title: "ุญุฌุฒ ูุณุงูุฏ",
                desc: "ุชุญุชุฌุฒ ูุณุงูุฏ ุงููุจูุบ ูุชุฎุตู ุฑุณูููุง (125.35 ุฑูุงู ุซุงุจุช ุฃู 2.4%).",
              },
              {
                step: "4", color: "bg-orange-500", title: "ุชุญููู ูุณุงูุฏ",
                desc: "ุจุนุฏ ูุตูู ุงูุนุงููุฉ ูุฎูุงู ุงูุฃูุงู ุงูุฎูุณุฉ ุงูุฃูููุ ุชูุญููู ูุณุงูุฏ ุงููุจูุบ ุจุนุฏ ุงูุฎุตู.",
              },
              {
                step: "5", color: "bg-navy-500", title: "ุชุญุช ุงูุถูุงู (90 ููู)",
                desc: "ุจุนุฏ ุงููุตููุ ูููุดุฆ ุงููุธุงู ุชููุงุฆูุงู ููุฏ EXTERNAL_COMMISSION_PAYABLE (ุงูุนูููุฉ ุงููุนููุฉ) ูููุญุฏููุซ ุงูุนูุฏ ุฅูู ยซุชุญุช ุงูุถูุงูยป. ูุชุฑุฉ ุถูุงู 90 ูููุงู ุชุจุฏุฃ.",
              },
              {
                step: "6", color: "bg-emerald-500", title: "ุชูุช ุงูุชุณููุฉ",
                desc: "ุงููุถุช ูุชุฑุฉ ุงูุถูุงู ุจุฏูู ูุดุงูู โ ุงูุนูุฏ ูุบูู ููุฑุจุญ.",
              },
            ].map((s) => (
              <div key={s.step} className="flex items-start gap-4 mb-4">
                <div className={`w-8 h-8 rounded-full ${s.color} text-white flex items-center justify-center font-bold shrink-0 text-sm`}>
                  {s.step}
                </div>
                <div className="flex-1 border-r-2 border-gray-100 pr-3">
                  <p className="font-bold text-gray-800">{s.title}</p>
                  <p className="text-gray-500 text-sm">{s.desc}</p>
                </div>
              </div>
            ))}
          </div>

          <div className="mt-4 bg-red-50 border border-red-200 rounded-xl p-4">
            <p className="font-bold text-red-800 mb-2">ุญุงูุงุช ุฎุฑูุฌ ุงูุนุงููุฉ ุจุนุฏ ุงููุตูู (ุฌุฏูุฏุฉ):</p>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm">
              {[
                ["ูุฑูุจ ุฎูุงู ุงูุถูุงู", "bg-red-100 text-red-800", "ููุนูุณ ููุฏ PAYABLE โ ููุฏ REVERSAL ุชููุงุฆู. ููุทูุจ ูุจูุบ ุงุณุชุฑุฏุงุฏ ุงููููู."],
                ["ุฅุฑุฌุงุน ุฎูุงู ุงูุถูุงู", "bg-orange-100 text-orange-800", "ููุณ ุฅุฌุฑุงุก ุงููุฑูุจ โ ุนูุณ PAYABLE + ุงุณุชุฑุฏุงุฏ ุงููููู ุงุฎุชูุงุฑู."],
                ["ูุฑูุจ ุจุนุฏ ุงูุถูุงู", "bg-gray-100 text-gray-600", "ูุง ุฅุฌุฑุงุก ูุงูู. ุงูุถูุงู ุงูุชูู. ููุณุฌููู ููุชูุซูู ููุท."],
                ["ุฅุฑุฌุงุน ุจุนุฏ ุงูุถูุงู", "bg-gray-100 text-gray-600", "ูุง ุฅุฌุฑุงุก ูุงูู. ุงูุถูุงู ุงูุชูู. ููุณุฌููู ููุชูุซูู ููุท."],
              ].map(([l, c, d]) => (
                <div key={l} className="flex items-start gap-2 bg-white rounded-lg p-2 border border-red-100">
                  <span className={`text-xs font-bold px-2 py-0.5 rounded-full shrink-0 ${c}`}>{l}</span>
                  <p className="text-gray-500 text-xs">{d}</p>
                </div>
              ))}
            </div>
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 3: Contract page fields                         */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec3" title="ุตูุญุฉ ุงูุนูุฏ โ ุดุฑุญ ูู ุญูู ูุงูู" icon="๐">

          <h3 className="font-bold text-navy-500 mb-3 text-base border-b pb-2">ูุณู ุงูุฅูุฑุงุฏุงุช</h3>
          <Field
            name="ูุจูุบ ุงูุนููู (client_payment)"
            desc="ุงููุจูุบ ุงููุงูู ุงูุฐู ุฏูุนู ุงูุนููู ุฅูู ููุตุฉ ูุณุงูุฏ ุจุงูุฑูุงู ุงูุณุนูุฏู."
            example="10,000 ุฑ.ุณ"
          />
          <Field
            name="ููุน ุฑุณูู ูุณุงูุฏ (musaned_fee_type)"
            desc="ุฅูุง ุซุงุจุช (125.35 ุฑูุงู) ุฃู ูุณุจุฉ ูุฆููุฉ (2.4% ูู ูุจูุบ ุงูุนููู)."
            example="ุซุงุจุช โ 125.35 ุฑ.ุณ | ูุณุจุฉ โ 10,000 ร 2.4% = 240 ุฑ.ุณ"
          />
          <Field
            name="ูููุฉ ุฑุณูู ูุณุงูุฏ (musaned_fee_value)"
            desc="ููุญุณุจ ุชููุงุฆูุงู ุจูุฌุฑุฏ ุงุฎุชูุงุฑ ููุน ุงูุฑุณูู ุฃู ุชุบููุฑ ูุจูุบ ุงูุนููู."
          />

          <div className="my-4">
            <Formula
              label="ุงููุชููุน ูู ูุณุงูุฏ"
              formula="ุงููุชููุน = ูุจูุบ ุงูุนููู โ ุฑุณูู ูุณุงูุฏ"
              result="10,000 โ 125.35 = 9,874.65 ุฑ.ุณ"
              note="ูุฐุง ูุง ูุชููุน ุงุณุชูุงูู ูู ูุณุงูุฏ ุจุนุฏ ุฎุตู ุฑุณูููู."
            />
          </div>

          <Field
            name="ุงููุณุชูู ูุนููุงู ูู ูุณุงูุฏ (actual_from_musaned)"
            desc="ุงููุจูุบ ุงููุนูู ุงูุฐู ุญููุชู ูุณุงูุฏ. ูุฏ ูุฎุชูู ููููุงู ุนู ุงููุชููุน (ุฃุญูุงูุงู ูุทุฑุญูู ุฑุณูู ุฅุถุงููุฉ)."
          />
          <Field
            name="ุชุงุฑูุฎ ุงูุชุญููู ูู ูุณุงูุฏ"
            desc="ุงูุชุงุฑูุฎ ุงููุนูู ุงูุฐู ูุตู ููู ุงูุชุญููู ูู ูุณุงูุฏ. ููุญุฏููุซ ูุฏููุงู ุนูุฏ ุงูุงุณุชูุงู."
          />
          <Field
            name="ุงููุนุงุก ุงูุถุฑูุจู (tax_base)"
            desc="ุงููุจูุบ ุงูุฎุงุถุน ูุถุฑูุจุฉ ุงููููุฉ ุงููุถุงูุฉ 15% (ุฅู ููุฌุฏ). ุงุฎุชูุงุฑู."
          />

          <h3 className="font-bold text-navy-500 mb-3 mt-5 text-base border-b pb-2">ูุณู ุงููุตุฑููุงุช</h3>

          <Field
            name="ุงูุนูููุฉ ุงูุฎุงุฑุฌูุฉ (external_commission_usd)"
            desc="ุฑุงุชุจ ุงูุนุงููุฉ ุงููุฏููุน ููููุชุจ ุงูุฎุงุฑุฌู ุจุงูุฏููุงุฑ ุงูุฃูุฑููู. ูุฐุง ุงูุฑูู ููุณุชุฎุฏู ุชููุงุฆูุงู ูุฅูุดุงุก ูููุฏ FORECAST ูPAYABLE ูREVERSAL."
            example="400 USD โ ููุญูููู ุชููุงุฆูุงู ร 3.75 = 1,500 ุฑ.ุณ"
          />

          <div className="my-4">
            <Formula
              label="ุชุญููู ุงูุนููุฉ"
              formula="ุจุงูุฑูุงู = ุงููุจูุบ ุจุงูุฏููุงุฑ ร 3.75"
              result="400 ร 3.75 = 1,500 ุฑ.ุณ"
              note="ุณุนุฑ ุงูุฏููุงุฑ ุซุงุจุช 3.75 ูู ูู ุงููุธุงู."
            />
          </div>

          <Field
            name="ุนูููุฉ ุฃุญูุฏ (ahmed_commission)"
            desc="ุนูููุฉ ุงููุณุคูู ุงูุฑุฆูุณู ุจุงูุฑูุงู ุงูุณุนูุฏู."
            example="500 ุฑ.ุณ"
          />
          <Field
            name="ุนูููุฉ ูุฌุฏู (wajdi_commission)"
            desc="ุนูููุฉ ูุณุคูู ุฅุฏุฎุงู ุงูุจูุงูุงุช ุจุงูุฑูุงู ุงูุณุนูุฏู."
          />
          <Field
            name="ุฑุณูู ุงูููุงูุฉ (agency_fee)"
            desc="ุฑุณูู ุงูููุงูุฉ ุงููุงููููุฉ โ ุซุงุจุชุฉ 136 ุฑูุงู ููู ุนูุฏ."
          />
          <Field
            name="ุนูููุฉ ุงูุจูู (pool_commission)"
            desc="ุนูููุฉ ุงุฎุชูุงุฑูุฉ ูููุณุงูููู ุฃู ุงูุดุฑูุงุก."
          />
          <Field
            name="ุตุฏูุฉ (sadaqa)"
            desc="ูุจูุบ ููุฎุตู ูุตุฏูุฉ โ ููุณ ูุตุฑููุงู ุชุดุบูููุงู ููู ููุถุงู ูููุตุงุฑูู."
          />
          <Field
            name="ูุตุงุฑูู ุฃุฎุฑู (other_expenses)"
            desc="ุฃู ูุตุงุฑูู ุฅุถุงููุฉ ุบูุฑ ูุฐููุฑุฉ ุฃุนูุงู."
          />

          <div className="my-4">
            <Formula
              label="ุฅุฌูุงูู ุงููุตุฑููุงุช"
              formula="ุงููุตุฑููุงุช = ุถุฑูุจุฉ + ุนูููุฉ ุฎุงุฑุฌูุฉ(ุฑ.ุณ) + ุนูููุฉ ุฃุญูุฏ + ุนูููุฉ ูุฌุฏู + ุฑุณูู ุงูููุงูุฉ + ุนูููุฉ ุงูุจูู + ุตุฏูุฉ + ูุตุงุฑูู ุฃุฎุฑู"
              note="ููุญุณุจ ุชููุงุฆูุงู ุจูุฌุฑุฏ ุชุบููุฑ ุฃู ูููุฉ."
            />
          </div>

          <h3 className="font-bold text-navy-500 mb-3 mt-5 text-base border-b pb-2">ุงูุฃุฑุจุงุญ</h3>

          <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div className="bg-orange-50 border border-orange-200 rounded-xl p-4">
              <p className="font-bold text-orange-800 mb-1">ุงูุฑุจุญ ุงูุชูุฑูุจู (approx_profit)</p>
              <p className="font-mono text-xs bg-orange-800 text-white rounded p-2 mb-2 text-left dir-ltr">
                = actual_from_musaned (ุฃู expected) โ total_expenses
              </p>
              <p className="text-orange-700 text-xs">
                ูุฐุง ุฑูู <strong>ุชูุฏูุฑู ููุท</strong>. ููุญุณุจ ูู ุจูุงูุงุช ุงูุนูุฏ ุงููุฏุฎูุฉ ูุฏููุงู.
                ูุง ูุนูุณ ุฃู ุชุนุฏููุงุช ูุงุญูุฉ.
              </p>
            </div>
            <div className="bg-emerald-50 border border-emerald-200 rounded-xl p-4">
              <p className="font-bold text-emerald-800 mb-1">ุงูุฑุจุญ ุงูุญูููู (ledger_profit)</p>
              <p className="font-mono text-xs bg-emerald-800 text-white rounded p-2 mb-2 text-left dir-ltr">
                = ฮฃ IN (ูุงุฑุฏ) โ ฮฃ OUT (ุตุงุฏุฑ)
              </p>
              <p className="text-emerald-700 text-xs">
                ูุฐุง ุงูุฑูู <strong>ูู ุงููุตุฏุฑ ุงูุญูููู</strong>. ููุญุณุจ ูู ุฏูุชุฑ ุงูุฃุณุชุงุฐ
                (ุฌุฏูู transactions) ููุนูุณ ูู ุงูุชุนุฏููุงุช ูุงูุฑุฏูุฏ ูุงูุนูููุงุช ุงููุนููุฉ.
              </p>
            </div>
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 4: Ledger (daftar al-ustad)                     */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec4" title="ุฏูุชุฑ ุงูุฃุณุชุงุฐ โ ุงูุณุฌู ุงููุญุงุณุจู" icon="๐">
          <p className="text-gray-600 mb-4 leading-relaxed">
            ุฏูุชุฑ ุงูุฃุณุชุงุฐ ูู <strong>ุงููุตุฏุฑ ุงูุญูููู ููุฃุฑูุงู ุงููุงููุฉ</strong>. ูู ุญุฑูุฉ ูุงููุฉ
            ูุณุฌูุฉ ููุง ูุง ุชูุญุฐู ููุง ุชูุนุฏููู โ ูููู ููุท ุฅุถุงูุฉ ูููุฏ ุฌุฏูุฏุฉ ุชุตุญูุญูุฉ.
          </p>

          <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-5">
            <div>
              <p className="font-bold text-emerald-700 mb-2">ุญุฑูุงุช ูุงุฑุฏ โ (IN)</p>
              <div className="space-y-1.5 text-sm">
                {[
                  ["ุฅูุฑุงุฏ ุงูุนูุฏ (CONTRACT_REVENUE)", "ูุจูุบ ุงูุนููู ุงููุณุชูู ูู ูุณุงูุฏ"],
                  ["ุงุณุชุฑุฏุงุฏ ุนูููุฉ ุฎุงุฑุฌูุฉ (EXTERNAL_COMMISSION_REVERSAL)", "ุฅุนุงุฏุฉ ุนูููุฉ ูู ููุชุจ ุฎุงุฑุฌู (ุถูุงู) โ ุชููุงุฆู ุนูุฏ ูุฑูุจ/ุฅุฑุฌุงุน ุฎูุงู ุงูุถูุงู"],
                  ["ุนูุณ ุชููุน ุนูููุฉ (EXTERNAL_COMMISSION_FORECAST โ IN)", "ูููุดุฃ ุชููุงุฆูุงู ุนูุฏ ุฅูุบุงุก ุนูุฏ ูุงู ูู ููุฏ FORECAST ุณุงุจู"],
                  ["ุชุนุฏูู ูุฏูู (IN)", "ุชุตุญูุญ ูุตุงูุญ ุงูุฑุจุญ"],
                ].map(([t, d]) => (
                  <div key={t} className="bg-emerald-50 rounded-lg p-2">
                    <p className="font-bold text-emerald-700 text-xs">{t}</p>
                    <p className="text-gray-500 text-xs">{d}</p>
                  </div>
                ))}
              </div>
            </div>
            <div>
              <p className="font-bold text-red-600 mb-2">ุญุฑูุงุช ุตุงุฏุฑ โ (OUT)</p>
              <div className="space-y-1.5 text-sm">
                {[
                  ["ุฑุณูู ูุณุงูุฏ (MASANED_FEE)", "ุงูุฑุณูู ุงููุฎุตููุฉ ูู ูุณุงูุฏ"],
                  ["ุชููุน ุนูููุฉ ุฎุงุฑุฌูุฉ (EXTERNAL_COMMISSION_FORECAST)", "ูููุดุฃ ุชููุงุฆูุงู ุนูุฏ ยซุชู ุงูุชุนุงูุฏยป. ุฑูู ุชูุจุคู โ ููุณ ุฏูุนุงู ูุนููุงู ุจุนุฏ"],
                  ["ุนูููุฉ ููุชุจ ุฎุงุฑุฌู (EXTERNAL_COMMISSION_PAYABLE)", "ูููุดุฃ ุชููุงุฆูุงู ุนูุฏ ยซุชู ุงููุตููยป. ูุฐู ูู ุงูุนูููุฉ ุงููุนููุฉ ุงููุณุชุญูุฉ"],
                  ["ุนูููุฉ ุฃุญูุฏ / ูุฌุฏู", "ุงูุนูููุงุช ุงูุฏุงุฎููุฉ"],
                  ["ุฑุณูู ุงูููุงูุฉ (AGENCY_FEE)", "136 ุฑูุงู ุซุงุจุชุฉ"],
                  ["ุงุณุชุฑุฏุงุฏ ููุนููู (CLIENT_REFUND)", "ูุจูุบ ููุนุงุฏ ููุนููู โ ุชููุงุฆู ุนูุฏ ุงูุฅูุบุงุก ุจุนุฏ 5 ุฃูุงู ุฃู ุญุฏุซ ุถูุงู"],
                  ["ูุตุงุฑูู ุฃุฎุฑู / ุชุนุฏูู ูุฏูู (OUT)", "ุฃู ูุตุฑูู ุขุฎุฑ"],
                ].map(([t, d]) => (
                  <div key={t} className="bg-red-50 rounded-lg p-2">
                    <p className="font-bold text-red-600 text-xs">{t}</p>
                    <p className="text-gray-500 text-xs">{d}</p>
                  </div>
                ))}
              </div>
            </div>
          </div>

          <div className="bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-4">
            <p className="font-bold text-yellow-800 mb-1">โ๏ธ FORECAST ููุงุจู PAYABLE โ ูุง ุงููุฑูุ</p>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm mt-2">
              <div className="bg-white rounded-lg p-3 border border-yellow-100">
                <p className="font-bold text-yellow-700">EXTERNAL_COMMISSION_FORECAST</p>
                <p className="text-gray-500 text-xs mt-1">
                  ูููุดุฃ ุนูุฏ ยซุชู ุงูุชุนุงูุฏยป. ูุนูู: ยซูู ุงููุชููุน ุฃู ูุฏูุน ูุฐุง ููููุชุจ ุฅุฐุง ุงูุชูู ุงูุนูุฏยป.
                  ุฅุฐุง ุฃููุบู ุงูุนูุฏุ ููุนูุณ ุชููุงุฆูุงู ุจููุฏ IN ูุทุงุจู ูุชุตุจุญ ุตุงููู = ุตูุฑ.
                  ูุง ูุฏุฎู ูู ุญุณุงุจ ุฑุตูุฏ ุงูููุชุจ ุงูุฎุงุฑุฌู.
                </p>
              </div>
              <div className="bg-white rounded-lg p-3 border border-yellow-100">
                <p className="font-bold text-red-600">EXTERNAL_COMMISSION_PAYABLE</p>
                <p className="text-gray-500 text-xs mt-1">
                  ูููุดุฃ ุนูุฏ ยซุชู ุงููุตููยป. ูุนูู: ยซูุตูุช ุงูุนุงููุฉ โ ุงูุนูููุฉ ูุงุฌุจุฉ ุงูุฏูุน ุงูุขูยป.
                  ูุฐุง ูู ุงููุจูุบ ุงูุฐู ูุฏุฎู ูู ุญุณุงุจ ุฑุตูุฏ ุงูููุชุจ ุงูุฎุงุฑุฌู ููุธูุฑ ูู ุญุณุงุจุงุช ุงูููุงุชุจ.
                </p>
              </div>
            </div>
          </div>

          <div className="bg-navy-50 rounded-xl p-4">
            <p className="font-bold text-navy-500 mb-2">ุงูุฑุตูุฏ ุงูุชุฑุงููู ูู ุงูุฌุฏูู</p>
            <p className="text-gray-600 text-sm">
              ูู ุณุทุฑ ูู ุฏูุชุฑ ุงูุฃุณุชุงุฐ ููุธูุฑ ุงูุฑุตูุฏ ุงูุชุฑุงููู ุญุชู ุชูู ุงููุญุธุฉ:
            </p>
            <p className="font-mono text-xs bg-navy-500 text-white rounded p-2 mt-2 text-left dir-ltr">
              ุฑุตูุฏ_ุชุฑุงููู = ูุฌููุน(ูู IN ุญุชู ุงูุขู) โ ูุฌููุน(ูู OUT ุญุชู ุงูุขู)
            </p>
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 5: Financial statuses                           */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec5" title="ุงูุญุงูุงุช ุงููุงููุฉ ุงูุณุชุฉ" icon="๐ท๏ธ">
          <p className="text-gray-500 text-sm mb-4">
            ูู ุนูุฏ ูู ุญุงูุฉ ูุงููุฉ ุชุนูุณ ุฃูู ููู ูู ุฏูุฑุฉ ุญูุงุชู. ุจุนุถูุง ููุญุฏููุซ ุชููุงุฆูุงูุ ูุงูุจุนุถ ูุฏูู.
          </p>
          <div className="space-y-2">
            <StatusInfo
              label="ูุญุฌูุฒ ุนูุฏ ูุณุงูุฏ"
              color="bg-gray-100 text-gray-700"
              desc="ุงูุนูุฏ ููุฌูุฏ ููุจูุบ ุงูุนููู ูุญุชุฌุฒ ูู ูุณุงูุฏ. ูู ูุชู ุงูุชุญููู ุจุนุฏ. ุงูุญุงูุฉ ุงูุงูุชุฑุงุถูุฉ ุนูุฏ ุฅูุดุงุก ุงูุนูุฏ."
            />
            <StatusInfo
              label="ุชู ุงุณุชูุงู ุงููุจูุบ"
              color="bg-blue-100 text-blue-700"
              desc="ูุตู ุงูุชุญููู ูู ูุณุงูุฏ. ูุฌุจ ุฅุฏุฎุงู actual_from_musaned ูุชุงุฑูุฎ ุงูุชุญููู."
            />
            <StatusInfo
              label="ููุบู ูุจู ุงููุตูู"
              color="bg-red-100 text-red-700"
              desc="ุชู ุฅูุบุงุก ุงูุนูุฏ ูุจู ูุตูู ุงูุนุงููุฉ. ููุญุฏููุซ ุชููุงุฆูุงู ุนูุฏ ุงูุฅูุบุงุก ุนุจุฑ ูุงูุฐุฉ ุงูุชุฃููุฏ. ูุฏ ูููู ููุนููู ุงุณุชุฑุฏุงุฏ ุฌุฒุฆู."
            />
            <StatusInfo
              label="ุชุญุช ุงูุถูุงู"
              color="bg-amber-100 text-amber-700"
              desc="ูุตูุช ุงูุนุงููุฉ. ูุจุฏุฃ ุถูุงู 90 ูููุงู. ููุญุฏููุซ ุชููุงุฆูุงู ุนูุฏ ุชุณุฌูู ุญุงูุฉ ยซุชู ุงููุตููยป."
            />
            <StatusInfo
              label="ูุณุชุฑุฏ ุฎูุงู ุงูุถูุงู"
              color="bg-purple-100 text-purple-700"
              desc="ุนุงุฏุช ุงูุนุงููุฉ ุฃู ูุฑุจุช ุฎูุงู ุงูู 90 ููู. ููุญุฏููุซ ุชููุงุฆูุงู ุนูุฏ ุงุฎุชูุงุฑ ุญุงูุฉ ยซูุฑูุจ ุฎูุงู ุงูุถูุงูยป ุฃู ยซุฅุฑุฌุงุน ุฎูุงู ุงูุถูุงูยป ุฃู ุงูุถุบุท ุนูู ุฒุฑ ยซุฅุฑุฌุงุน ุฎูุงู ุงูุถูุงูยป."
            />
            <StatusInfo
              label="ุชูุช ุงูุชุณููุฉ"
              color="bg-emerald-100 text-emerald-700"
              desc="ุงููุถุช ูุชุฑุฉ ุงูุถูุงู ุจูุฌุงุญ. ุงูุนูุฏ ูุบูู ููุงุฆูุงู ูุงูุฑุจุญ ูุญุณูุจ."
            />
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 6: Financial reports                            */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec6" title="ุตูุญุฉ ุงูุชูุงุฑูุฑ ุงููุงููุฉ" icon="๐">
          <p className="text-gray-600 mb-4">
            ุชุฌูุน ุงูุชูุงุฑูุฑ ุงููุงููุฉ ุจูู <strong>ุจูุงูุงุช ุฌุฏูู contracts</strong> (ููุฃุฑูุงู ุงููุฏุฎูุฉ ููุณุงูุฏ)
            ู<strong>ูุดูุฏ contract_profit</strong> (ุงูุฑุจุญ ุงูุญูููู ูู ุงูุณุฌู).
          </p>

          <div className="space-y-3">
            <div className="bg-gray-50 rounded-xl p-3 text-sm">
              <p className="font-bold text-navy-500">ุงููุชููุน ูู ูุณุงูุฏ ุงูุฅุฌูุงูู</p>
              <p className="text-gray-500">= ูุฌููุน (ูุจูุบ ุงูุนููู โ ุฑุณูู ูุณุงูุฏ) ููู ุงูุนููุฏ ูู ุงููุชุฑุฉ ุงููุญุฏุฏุฉ.</p>
            </div>
            <div className="bg-gray-50 rounded-xl p-3 text-sm">
              <p className="font-bold text-navy-500">ุงููุณุชูู ูุนููุงู ุงูุฅุฌูุงูู</p>
              <p className="text-gray-500">= ูุฌููุน actual_from_musaned ููุนููุฏ ุงูุชู ูุตู ุชุญููููุง. ุงูุนููุฏ ุงูุชู ูู ูุตู ุชุญููููุง ุชูุธูุฑ "โณ ูู ูุตู" ุจุงูููู ุงูุจุฑุชูุงูู.</p>
            </div>
            <div className="bg-gray-50 rounded-xl p-3 text-sm">
              <p className="font-bold text-navy-500">ูุนูู ุงูุชุญููู</p>
              <p className="text-gray-500">= ุนุฏุฏ ุงูุนููุฏ ุงูุชู ูู ูุตู ุชุญููู ูุณุงูุฏ ููุง ููู ุชููุบู. ูุฐู ุชุญุชุงุฌ ูุชุงุจุนุฉ.</p>
            </div>
            <div className="bg-gray-50 rounded-xl p-3 text-sm">
              <p className="font-bold text-navy-500">ุงูุฑุจุญ ุงูุฅุฌูุงูู</p>
              <p className="text-gray-500">= ูุฌููุน ledger_profit ูู ูุดูุฏ contract_profit (ุงูุณุฌู ุงูุญูููู).</p>
            </div>
            <div className="bg-amber-50 border border-amber-200 rounded-xl p-3 text-sm">
              <p className="font-bold text-amber-800">ุงูุตู ุงููููุฒ ุจุงูุจุฑุชูุงูู ูู ุงูุฌุฏูู</p>
              <p className="text-amber-700">= ุนูุฏ ูู ูุณุชูู ุชุญููู ูุณุงูุฏ ุจุนุฏ ููู ูููุบู. ูุญุชุงุฌ ูุชุงุจุนุฉ ุนุงุฌูุฉ.</p>
            </div>
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 7: Analytics                                    */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec7" title="ุตูุญุฉ ุงูุชุญูููุงุช" icon="๐">
          <div className="space-y-3 text-sm">
            {[
              ["ุงูุฑุณู ุงูุดูุฑู", "ุนุฏุฏ ุงูุนููุฏ ููู ุดูุฑ ูู ุงูุณูุฉ ุงููุฎุชุงุฑุฉ. ููุถุญ ุงูููุณููุฉ ูุงูููู."],
              ["ุงูุฑุณู ุงููุตูู", "ูุฌูุน ุงูุฃุดูุฑ ูู 4 ุฃุฑุจุงุน (Q1โQ4). ูููุฏ ูููุงุฑูุฉ ุงูุฃุฑุจุงุน."],
              ["ุชูุฒูุน ุงูุฌูุณูุงุช", "ุงูุฏุงุฆุฑุฉ ุชูุธูุฑ ูุณุจุฉ ูู ุฌูุณูุฉ ูู ุฅุฌูุงูู ุงูุนููุฏ. ูููุฏ ููุนุฑูุฉ ุงูุทูุจ."],
              ["ุงูููุงุชุจ ุงูุฎุงุฑุฌูุฉ (ุฃูุซุฑ ุงุณุชุฎุฏุงูุงู)", "ุฃููู โ ููุธูุฑ ุงูููุงุชุจ ุงูุฃูุซุฑ ุนููุฏุงู. ูุณุงุนุฏ ูู ุชูููู ุงูุดุฑุงูุงุช."],
              ["ุชูุฑูุฑ ุงููุตูู", "ูุชูุณุท ุฃูุงู ุงููุตูู = ูุฌููุน (ุชุงุฑูุฎ ุงููุตูู โ ุชุงุฑูุฎ ุงูุนูุฏ) รท ุนุฏุฏ ุงููุตููุงุช. ูููุณ ููุงุกุฉ ุงูุนูููุฉ."],
              ["ูุนุฏู ุงูุฅูุบุงุก/ุงูุงุณุชุฑุฏุงุฏ ุจุงูุฌูุณูุฉ", "ูุณุจุฉ ุงูุนููุฏ ุงูููุบุงุฉ ุฃู ุงููุณุชุฑุฏุฉ ููู ุฌูุณูุฉ. ููุญุฐุฑ ูู ุฌูุณูุฉ ุฐุงุช ูุดุงูู ุฃูุซุฑ."],
            ].map(([t, d]) => (
              <div key={t} className="bg-gray-50 rounded-xl p-3">
                <p className="font-bold text-navy-500">{t}</p>
                <p className="text-gray-500">{d}</p>
              </div>
            ))}
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 8: Delayed contracts                            */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec8" title="ุตูุญุฉ ุงูุนููุฏ ุงููุชุฃุฎุฑุฉ" icon="โ๏ธ">
          <p className="text-gray-600 mb-4 text-sm">
            ุชูุธูุฑ ุงูุนููุฏ ุงูุชู ูุถู ุนูู ุชุงุฑูุฎ ุงูุชุนุงูุฏ ุฃูุซุฑ ูู 30 ูููุงู ููู ุชุตู ูููุง ุงูุนุงููุฉ ููู ุชููุบู.
          </p>
          <Formula
            label="ุฃูุงู ุงูุชุฃุฎูุฑ"
            formula="ุงูุชุฃุฎูุฑ = ุชุงุฑูุฎ ุงูููู โ ุชุงุฑูุฎ ุงูุนูุฏ"
            note="ุชูุญุณุจ ูู DB ูุจุงุดุฑุฉ ูู ูุดูุฏ delayed_contracts."
          />
          <div className="space-y-2 mt-4">
            {[
              ["30โ60 ููู", "bg-yellow-100 text-yellow-800", "ุชุญุชุงุฌ ูุชุงุจุนุฉ โ ุฑุจูุง ุชุฃุฎูุฑ ูู ุงูุฅุฌุฑุงุกุงุช."],
              ["60โ90 ููู", "bg-orange-100 text-orange-800", "ุชุฃุฎูุฑ ูุจูุฑ โ ุชูุงุตู ูุน ุงูููุชุจ ุงูุฎุงุฑุฌู ููุฑุงู."],
              ["+90 ููู", "bg-red-100 text-red-800", "ุชุฃุฎูุฑ ุญุฑุฌ โ ูุฌุจ ุงุชุฎุงุฐ ุฅุฌุฑุงุก ููุฑู (ุฅูุบุงุก ุฃู ูุชุงุจุนุฉ ูุงููููุฉ)."],
            ].map(([l, c, d]) => (
              <div key={l} className="flex items-start gap-3">
                <span className={`text-xs font-bold px-2 py-1 rounded-full shrink-0 ${c}`}>{l}</span>
                <p className="text-gray-600 text-sm">{d}</p>
              </div>
            ))}
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 9: Owner dashboard                              */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec9" title="ููุญุฉ ุงููุงูู (ุฃุจู ุชุฑูู)" icon="๐๏ธ">
          <p className="text-gray-600 mb-4 text-sm">
            ููุงุทูุงุน ููุท โ ูุง ูููู ุงูุชุนุฏูู. ูู ุงูุฃุฑูุงู ูุฃุฎูุฐุฉ ูู ุงููุตุงุฏุฑ ุงูุญููููุฉ.
          </p>
          <div className="space-y-2 text-sm">
            {[
              ["ุงูุฅูุฑุงุฏ ุงูุฅุฌูุงูู", "ูุฌููุน client_payment ููู ุนููุฏ ุงูุณูุฉ."],
              ["ุฑุจุญ ุงูุณุฌู", "ูุฌููุน ledger_profit ูู ูุดูุฏ contract_profit."],
              ["ุฅุฌูุงูู ุงููุชููุน ูู ูุณุงูุฏ", "ูุฌููุน expected_from_musaned."],
              ["ุฅุฌูุงูู ุงููุณุชูู ูู ูุณุงูุฏ", "ูุฌููุน actual_from_musaned ููุนููุฏ ุงูุชู ูุตู ุชุญููููุง."],
              ["ุนููุฏ ูุนููุฉ", "ุนุฏุฏ ุงูุนููุฏ ุจุฏูู actual_from_musaned ููู ุชููุบู."],
              ["ุฏููู ุงูููุงุชุจ ุงูุฎุงุฑุฌูุฉ", "ูุฌููุน balance_usd ูู ูุดูุฏ external_office_balances ร 3.75."],
            ].map(([t, d]) => (
              <div key={t} className="bg-gray-50 rounded-lg p-3">
                <span className="font-bold text-navy-500">{t}: </span>
                <span className="text-gray-600">{d}</span>
              </div>
            ))}
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 10: External accounts                           */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec10" title="ุญุณุงุจุงุช ุงูููุงุชุจ ุงูุฎุงุฑุฌูุฉ" icon="๐ข">
          <p className="text-gray-600 mb-4 text-sm">
            ุชุชุจุน ูุง ูุณุชุญูู ูู ููุชุจ ุฎุงุฑุฌู ูููุฏุงุฑ ูุง ุฏูุนูุงู ููู.
          </p>

          <div className="space-y-3">
            <Formula
              label="ุฅุฌูุงูู ุงููุณุชุญู ุงูุฅุฌูุงูู (gross_owed_usd)"
              formula="= ูุฌููุน ูููุฏ EXTERNAL_COMMISSION_PAYABLE (ุจุงูุฏููุงุฑ) ููู ุนููุฏ ุงูููุชุจ"
              note="ูุงุญุธ: ูููุฏ FORECAST ูุง ุชุฏุฎู ููุง โ ููุท PAYABLE (ุจุนุฏ ุงููุตูู ุงููุนูู)."
            />
            <Formula
              label="ุงูุงุณุชุฑุฏุงุฏุงุช (total_reversal_usd)"
              formula="= ูุฌููุน ูููุฏ EXTERNAL_COMMISSION_REVERSAL (ุจุงูุฏููุงุฑ)"
              note="ุนูุฏ ูุฑูุจ/ุฅุฑุฌุงุน ุงูุนุงููุฉ ูู ุงูุถูุงูุ ูููุดุฃ REVERSAL ุชููุงุฆูุงู ูููุฎุตู ููุง."
            />
            <Formula
              label="ุตุงูู ุงููุณุชุญู (total_owed_usd)"
              formula="= gross_owed_usd โ total_reversal_usd"
            />
            <Formula
              label="ุฅุฌูุงูู ุงููุฏููุน (total_paid_usd)"
              formula="= ูุฌููุน ุงูุณุฌูุงุช ูู ุฌุฏูู external_accounts ููููุชุจ"
              note="ุงูุฏูุนุงุช ุงููุณุฌูุฉ ูุฏููุงู ุนูุฏ ุงูุชุญููู ุงููุนูู ููููุชุจ."
            />
            <Formula
              label="ุงูุฑุตูุฏ (balance_usd)"
              formula="= total_owed_usd โ total_paid_usd"
              result="ููุฌุจ = ูุงุฒููุง ูุฏูููู ููููุชุจ | ุณุงูุจ = ุงูููุชุจ ูุฏูู ููุง"
            />
          </div>

          <div className="mt-4 grid grid-cols-1 sm:grid-cols-3 gap-3 text-xs text-center">
            <div className="bg-orange-50 border border-orange-200 rounded-xl p-3">
              <p className="font-bold text-orange-700 text-sm mb-1">ุฑุตูุฏ ููุฌุจ (+)</p>
              <p className="text-orange-600">ูุงุฒููุง ูุฏูู ููููุชุจ ุจูุฐุง ุงููุจูุบ. ูุฌุจ ุฏูุนู.</p>
            </div>
            <div className="bg-emerald-50 border border-emerald-200 rounded-xl p-3">
              <p className="font-bold text-emerald-700 text-sm mb-1">ุฑุตูุฏ ุตูุฑ (0)</p>
              <p className="text-emerald-600">ุงูุญุณุงุจ ูุณุฏุฏ ุจุงููุงูู.</p>
            </div>
            <div className="bg-purple-50 border border-purple-200 rounded-xl p-3">
              <p className="font-bold text-purple-700 text-sm mb-1">ุฑุตูุฏ ุณุงูุจ (โ)</p>
              <p className="text-purple-600">ุงูููุชุจ ูุฏูู ููุง (ุฏูุนูุง ุฃูุซุฑ ููุง ูุณุชุญูุ ุฃู ุงุณุชุฑุฏููุง ุนูููุงุช).</p>
            </div>
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 11: Guarantee events                            */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec11" title="ุฃุญุฏุงุซ ุงูุถูุงู ูุนูุฏุฉ ุงูุนุงููุฉ" icon="๐">
          <div className="bg-amber-50 border border-amber-200 rounded-xl p-4 mb-5">
            <p className="font-bold text-amber-800 mb-1">ูุชู ูุจุฏุฃ ุงูุถูุงูุ</p>
            <p className="text-amber-700 text-sm">
              ููุฑ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ ุฅูู <strong>ยซุชู ุงููุตููยป</strong>ุ ููุญุฏููุซ ุงูุนูุฏ ุชููุงุฆูุงู:
              ุชููุดุฃ ุนูููุฉ ุงูููุชุจ (PAYABLE)ุ ูุชูุตุจุญ ุงูุญุงูุฉ ุงููุงููุฉ <strong>ุชุญุช ุงูุถูุงู</strong>ุ
              ูุชูุญุณุจ ุชุงุฑูุฎ ุงูุชูุงุก ุงูุถูุงู = ุชุงุฑูุฎ ุงููุตูู + 90 ูููุงู.
            </p>
          </div>

          <p className="font-bold text-navy-500 mb-3">ุฎูุงุฑุงุช ุงูุนุงููุฉ ุจุนุฏ ุงููุตูู:</p>

          <div className="space-y-4">
            {/* Runaway/return within 90 */}
            <div className="bg-red-50 border border-red-200 rounded-xl p-4">
              <p className="font-bold text-red-800 mb-2">ูุฑูุจ ุฃู ุฅุฑุฌุงุน ุฎูุงู ุงูุถูุงู (ุฎูุงู 90 ูููุงู)</p>
              <p className="text-red-700 text-sm mb-3">
                ุบููุฑ ุญุงูุฉ ุงูุทูุจ ุฅูู <strong>ยซูุฑูุจ ุฎูุงู ุงูุถูุงูยป</strong> ุฃู <strong>ยซุฅุฑุฌุงุน ุฎูุงู ุงูุถูุงูยป</strong>ุ
                ุฃู ุงุถุบุท ุฒุฑ <strong>ยซุฅุฑุฌุงุน ุฎูุงู ุงูุถูุงูยป</strong> ุงูุธุงูุฑ ูู ุฑุฃุณ ุตูุญุฉ ุงูุทูุจ.
                ุณุชุธูุฑ ูุงูุฐุฉ ุชุทูุจ ูุจูุบ ุงุณุชุฑุฏุงุฏ ุงููููู (ุฅู ููุฌุฏ).
              </p>
              <p className="font-bold text-red-700 text-xs mb-1">ูุง ูุญุฏุซ ุชููุงุฆูุงู:</p>
              <div className="space-y-1 text-xs text-red-700">
                <p>โ ุฅูุดุงุก ููุฏ EXTERNAL_COMMISSION_REVERSAL (ูุงุฑุฏ โ ุจุงูุฏููุงุฑ) โ ููุนูุฏ ุงุญุชุณุงุจ ุฑุตูุฏ ุงูููุชุจ</p>
                <p>โ ุฅูุดุงุก ููุฏ CLIENT_REFUND (ุตุงุฏุฑ โ ุจุงูุฑูุงู) ุฅุฐุง ุฃุฏุฎูุช ูุจูุบุงู ุฃูุจุฑ ูู ุตูุฑ</p>
                <p>โ ุชุญุฏูุซ ุงูุญุงูุฉ ุงููุงููุฉ ููุนูุฏ ุฅูู ยซูุณุชุฑุฏ ุฎูุงู ุงูุถูุงูยป</p>
                <p>โ ุชุณุฌูู ุชุงุฑูุฎ ุงูุฅุฑุฌุงุน = ุงูููู ูู ุงูุทูุจ</p>
              </div>
            </div>

            {/* Runaway/return after 90 */}
            <div className="bg-gray-50 border border-gray-200 rounded-xl p-4">
              <p className="font-bold text-gray-700 mb-2">ูุฑูุจ ุฃู ุฅุฑุฌุงุน ุจุนุฏ ุงูุถูุงู (ุจุนุฏ 90 ูููุงู)</p>
              <p className="text-gray-600 text-sm">
                ุบููุฑ ุญุงูุฉ ุงูุทูุจ ุฅูู <strong>ยซูุฑูุจ ุจุนุฏ ุงูุถูุงูยป</strong> ุฃู <strong>ยซุฅุฑุฌุงุน ุจุนุฏ ุงูุถูุงูยป</strong>.
                <br />
                <span className="text-gray-500">ูุง ููุฌุฏ ุฃู ุฅุฌุฑุงุก ูุงูู ุชููุงุฆู โ ุงูุถูุงู ุงูุชููุ ุงูุนูููุฉ ูุญุชุณุจุฉ ููุงุฆูุงู.</span>
              </p>
            </div>
          </div>

          <div className="mt-5 bg-blue-50 border border-blue-200 rounded-xl p-4 text-sm">
            <p className="font-bold text-blue-800 mb-2">ูุงุฐุง ูุญุฏุซ ูุฃุฑูุงู ุงูุฑุจุญ ุจุนุฏ ุญุฏุซ ุงูุถูุงูุ</p>
            <div className="space-y-1 text-blue-700 text-xs">
              <p>โข <strong>ledger_profit</strong> ููุฎูุถ ุจุณุจุจ ููุฏ CLIENT_REFUND (OUT)</p>
              <p>โข <strong>ุฑุตูุฏ ุงูููุชุจ ุงูุฎุงุฑุฌู</strong> ููุฎูุถ ุจุณุจุจ EXTERNAL_COMMISSION_REVERSAL (ูุฎุตูู ูู ุงูู total_owed)</p>
              <p>โข <strong>ููุญุฉ ุงููุงูู ูุงูุชูุงุฑูุฑ</strong> ุชุนูุณ ุงูุชุบููุฑ ุชููุงุฆูุงู</p>
              <p>โข ูู ูุฐุง ุจุฏูู ุฃู ุชุนุฏูู ุฃู ุญุฐู โ ููุท ุฅุถุงูุฉ ูููุฏ ุฌุฏูุฏุฉ โ</p>
            </div>
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* SECTION 12: Status-driven financial engine              */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <Section id="sec12" title="ูุญุฑู ุงูุฅุฌุฑุงุกุงุช ุงููุงููุฉ ุงูุชููุงุฆูุฉ" icon="โ๏ธ">
          <p className="text-gray-600 mb-5 leading-relaxed">
            ูู ุชุบููุฑ ูู ุญุงูุฉ ุงูุทูุจ ููุดุบูู ูุญุฑูุงู ุฏุงุฎููุงู ูููุฑุฑ ูู ูุญุชุงุฌ ูุฅุฌุฑุงุก ูุงูู.
            ูุง ุชุญุชุงุฌ ููุชุญ ุฏูุชุฑ ุงูุฃุณุชุงุฐ ูุฏููุงู ูู ูุนุธู ุงูุญุงูุงุช โ ุงููุธุงู ููุนู ุฐูู ููุงุจุฉู ุนูู.
          </p>

          {/* Full trigger table */}
          <div className="overflow-x-auto mb-6">
            <table className="w-full text-sm border-collapse">
              <thead>
                <tr className="bg-navy-500 text-white">
                  <th className="text-right p-3 rounded-tr-xl">ุญุงูุฉ ุงูุทูุจ ุงูุฌุฏูุฏุฉ</th>
                  <th className="text-right p-3">ุงูุฅุฌุฑุงุก ุงููุงูู</th>
                  <th className="text-right p-3 rounded-tl-xl">ููุงุญุธุงุช</th>
                </tr>
              </thead>
              <tbody>
                {[
                  {
                    status: "ุชู ุงูุชุนุงูุฏ", statusColor: "bg-indigo-100 text-indigo-800",
                    action: "ุฅูุดุงุก EXTERNAL_COMMISSION_FORECAST (ุตุงุฏุฑ โ ุจุงูุฏููุงุฑ)",
                    note: "ููุท ุฅุฐุง external_commission_usd > 0. ูุง ูุชูุฑุฑ (idempotent).",
                    rowColor: "bg-indigo-50",
                  },
                  {
                    status: "ุชู ุงููุตูู", statusColor: "bg-emerald-100 text-emerald-800",
                    action: "ุฅูุดุงุก EXTERNAL_COMMISSION_PAYABLE (ุตุงุฏุฑ โ) + ุชุญุฏูุซ ุงูุนูุฏ ุฅูู ยซุชุญุช ุงูุถูุงูยป",
                    note: "FORECAST ุงูุณุงุจู ูุจูู ูุณุฌู ุชุงุฑูุฎู. ูุง ูุชูุฑุฑ.",
                    rowColor: "bg-emerald-50",
                  },
                  {
                    status: "ููุบู", statusColor: "bg-red-100 text-red-800",
                    action: "ูุงูุฐุฉ: ุงุฎุชุฑ ยซุฎูุงู 5 ุฃูุงูยป ุฃู ยซุจุนุฏ 5 ุฃูุงูยป",
                    note: "ุฑุงุฌุน ุชูุงุตูู ุงูุฅูุบุงุก ุฃุฏูุงู.",
                    rowColor: "bg-red-50",
                  },
                  {
                    status: "ูุฑูุจ ุฎูุงู ุงูุถูุงู", statusColor: "bg-red-100 text-red-800",
                    action: "ูุงูุฐุฉ: ูุจูุบ ุงุณุชุฑุฏุงุฏ ุงููููู โ REVERSAL + CLIENT_REFUND",
                    note: "ุชููุงุฆู. ูุง ูุชูุฑุฑ ุฅุฐุง ูุงู REVERSAL ููุฌูุฏ ูุณุจูุงู.",
                    rowColor: "bg-red-50",
                  },
                  {
                    status: "ุฅุฑุฌุงุน ุฎูุงู ุงูุถูุงู", statusColor: "bg-orange-100 text-orange-800",
                    action: "ูุงูุฐุฉ: ูุจูุบ ุงุณุชุฑุฏุงุฏ ุงููููู โ REVERSAL + CLIENT_REFUND",
                    note: "ููุณ ุฅุฌุฑุงุก ุงููุฑูุจ ุชูุงูุงู.",
                    rowColor: "bg-orange-50",
                  },
                  {
                    status: "ูุฑูุจ ุจุนุฏ ุงูุถูุงู", statusColor: "bg-gray-100 text-gray-600",
                    action: "โ ูุง ุฅุฌุฑุงุก ูุงูู",
                    note: "ุงูุถูุงู ุงูุชูู. ููุชูุซูู ููุท.",
                    rowColor: "bg-gray-50",
                  },
                  {
                    status: "ุฅุฑุฌุงุน ุจุนุฏ ุงูุถูุงู", statusColor: "bg-gray-100 text-gray-600",
                    action: "โ ูุง ุฅุฌุฑุงุก ูุงูู",
                    note: "ุงูุถูุงู ุงูุชูู. ููุชูุซูู ููุท.",
                    rowColor: "bg-gray-50",
                  },
                  {
                    status: "ุจุงูู ุงูุญุงูุงุช", statusColor: "bg-blue-100 text-blue-800",
                    action: "โ ูุง ุฅุฌุฑุงุก ูุงูู",
                    note: "selected / medical_exam / ticket_booked ... ุฅูุฎ.",
                    rowColor: "bg-white",
                  },
                ].map((row) => (
                  <tr key={row.status} className={`border-b border-gray-200 ${row.rowColor}`}>
                    <td className="p-3">
                      <span className={`text-xs font-bold px-2 py-1 rounded-full ${row.statusColor}`}>
                        {row.status}
                      </span>
                    </td>
                    <td className="p-3 text-gray-700 text-xs">{row.action}</td>
                    <td className="p-3 text-gray-400 text-xs">{row.note}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>

          {/* Cancellation details */}
          <h3 className="font-bold text-navy-500 mb-3 text-base border-b pb-2">ุชูุงุตูู ูุงูุฐุฉ ุงูุฅูุบุงุก</h3>
          <p className="text-gray-500 text-sm mb-4">
            ุนูุฏ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ ุฅูู ยซููุบูยป ูุญูุธูุ ุชุธูุฑ ูุงูุฐุฉ ุชุณุฃูู ุนู ุชูููุช ุงูุฅูุบุงุก:
          </p>

          <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-5">
            <div className="bg-green-50 border-2 border-green-300 rounded-xl p-4">
              <p className="font-bold text-green-800 mb-2">ุฎูุงู 5 ุฃูุงู ูู ุฅุตุฏุงุฑ ุงูุนูุฏ</p>
              <div className="space-y-1 text-xs text-green-700">
                <p>โ ุชุญุฏูุซ contracts.cancellation_status = within_5_days</p>
                <p>โ ุชุญุฏูุซ financial_status = cancelled_before_arrival</p>
                <p>โ ุนูุณ FORECAST: ุฅูุดุงุก EXTERNAL_COMMISSION_FORECAST (ูุงุฑุฏ โ) ุฅุฐุง ูุงู ููุฌูุฏุงู</p>
                <p>โ ูุง ุงุณุชุฑุฏุงุฏ ูููููู</p>
              </div>
              <p className="text-green-600 text-xs mt-2 bg-green-100 rounded p-1">
                ุงูุญุงูุฉ: ุงูููุชุจ ุงูุฎุงุฑุฌู ูุง ูุณุชุญู ุดูุฆุงู โ ุงูุตุงูู ุตูุฑ.
              </p>
            </div>
            <div className="bg-orange-50 border-2 border-orange-300 rounded-xl p-4">
              <p className="font-bold text-orange-800 mb-2">ุจุนุฏ 5 ุฃูุงู ูู ุฅุตุฏุงุฑ ุงูุนูุฏ</p>
              <div className="space-y-1 text-xs text-orange-700">
                <p>โ ุชุญุฏูุซ contracts.cancellation_status = after_5_days</p>
                <p>โ ุชุญุฏูุซ financial_status = cancelled_before_arrival</p>
                <p>โ ุฅูุดุงุก CLIENT_REFUND (ุตุงุฏุฑ โ ุจุงูุฑูุงู) ุฅุฐุง ุฃุฏุฎูุช ูุจูุบุงู</p>
                <p>โ ุนูุณ FORECAST: ุฅูุดุงุก EXTERNAL_COMMISSION_FORECAST (ูุงุฑุฏ โ) ุฅุฐุง ูุงู ููุฌูุฏุงู</p>
              </div>
              <p className="text-orange-600 text-xs mt-2 bg-orange-100 rounded p-1">
                ุงูุญุงูุฉ: ูุฌุจ ุฑุฏ ุฌุฒุก ูู ุงููุจูุบ ูููููู. ุฃุฏุฎู ุงูุฑูู ุจุงูุฑูุงู ูู ุงูุญูู.
              </p>
            </div>
          </div>

          <div className="bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm mb-5">
            <p className="font-bold text-gray-700 mb-1">ุฒุฑ ยซุชุฎุทู (ุจุฏูู ุฅุฌุฑุงุก ูุงูู)ยป</p>
            <p className="text-gray-500 text-xs">
              ุฅุฐุง ุถุบุทุช ุชุฎุทู ูู ูุงูุฐุฉ ุงูุฅูุบุงุกุ ููุบูู ุงูุทูุจ ููยซููุบูยป ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููู
              ูุง ูููุดุฃ ุฃู ููุฏ ูุงูู. ุงุณุชุฎุฏู ูุฐุง ููุท ุฅุฐุง ููุช ุณุชูุฏุฎู ุงููููุฏ ูุฏููุงู ูุงุญูุงู
              ูู ุฏูุชุฑ ุงูุฃุณุชุงุฐ.
            </p>
          </div>

          {/* Idempotency note */}
          <div className="bg-blue-50 border border-blue-200 rounded-xl p-4">
            <p className="font-bold text-blue-800 mb-2">๐ ูุจุฏุฃ ุนุฏู ุงูุชูุฑุงุฑ (Idempotency)</p>
            <p className="text-blue-700 text-sm">
              ูุจู ุฅูุดุงุก ุฃู ููุฏ ุชููุงุฆูุ ูุชุญูู ุงููุธุงู ุฃู ูุฐุง ุงูููุฏ ุบูุฑ ููุฌูุฏ ูุณุจูุงู.
              ุฅุฐุง ุญูุธุช ุงูุทูุจ ูุฑุชูู ุจููุณ ุงูุญุงูุฉุ ูู ุชููุดุฃ ูููุฏ ููุฑุฑุฉ.
              ูุฐุง ูุญูู ุงูุณุฌู ุงููุญุงุณุจู ูู ุงูุชุถุฎูู ุบูุฑ ุงูููุตูุฏ.
            </p>
          </div>
        </Section>

        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        {/* Quick reference card                                    */}
        {/* โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ */}
        <div className="card mb-6 bg-navy-500 text-white">
          <h2 className="text-xl font-bold mb-4">ูุฑุฌุน ุณุฑูุน โ ุฃูู ุงููุนุงุฏูุงุช</h2>
          <div className="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
            {[
              ["ุงููุชููุน ูู ูุณุงูุฏ", "ูุจูุบ ุงูุนููู โ ุฑุณูู ูุณุงูุฏ"],
              ["ุฑุณูู ูุณุงูุฏ", "125.35 ุฑ.ุณ  ุฃู  ูุจูุบ ุงูุนููู ร 2.4%"],
              ["ุฅุฌูุงูู ุงููุตุฑููุงุช", "ุถุฑูุจุฉ + ุนูููุงุช + ููุงูุฉ + ูุตุงุฑูู ุฃุฎุฑู"],
              ["ุงูุฑุจุญ ุงูุชูุฑูุจู", "actual_from_musaned โ total_expenses"],
              ["ุฑุจุญ ุงูุณุฌู (ุงูุญูููู)", "ฮฃ IN โ ฮฃ OUT (ูู transactions)"],
              ["ุงูุนูููุฉ ุงูุฎุงุฑุฌูุฉ ุจุงูุฑูุงู", "ุงูุนูููุฉ USD ร 3.75"],
              ["ุฑุตูุฏ ุงูููุชุจ ุงูุฎุงุฑุฌู", "ุตุงูู ุงููุณุชุญู (PAYABLEโREVERSAL) โ ุฅุฌูุงูู ุงููุฏููุน"],
              ["FORECAST โ ุฅูุบุงุก ุฎูุงู 5 ุฃูุงู", "FORECAST OUT + FORECAST IN = ุตุงูู ุตูุฑ"],
              ["FORECAST โ ูุตูู ุงูุนุงููุฉ", "FORECAST ูุจูู ูุณุฌู + PAYABLE ูููุดุฃ ุฌุฏูุฏุงู"],
              ["ุญุฏุซ ุถูุงู", "PAYABLE + REVERSAL = ุตุงูู ุตูุฑ ููููุชุจ"],
              ["ุชุงุฑูุฎ ุงูุชูุงุก ุงูุถูุงู", "ุชุงุฑูุฎ ุงููุตูู + 90 ูููุงู"],
            ].map(([k, v]) => (
              <div key={k} className="bg-white/10 rounded-lg p-3">
                <p className="font-bold text-blue-200 text-xs">{k}</p>
                <p className="font-mono text-white text-xs mt-0.5">{v}</p>
              </div>
            ))}
          </div>
        </div>

        <footer className="text-center text-gray-400 text-xs pb-6">
          ุงูุฏููู ุงููุงูู โ ูุธุงู ุญููู ุงูุดุฑู ููุงุณุชูุฏุงู ยท ุขุฎุฑ ุชุญุฏูุซ {new Date().toLocaleDateString("ar-SA")}
        </footer>
      </div>
    </AuthLayout>
  );
}
